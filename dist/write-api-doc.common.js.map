{"version":3,"file":"write-api-doc.common.js","sources":["../src/helper.js","../src/parser.js","../src/apidoc.js","../src/writer.js","../src/index.js"],"sourcesContent":["export const api = (method, path, title) => `* @api {${method}} ${path} ${title}`\r\nexport const apiName = name => `* @apiName ${name}`\r\nexport const apiGroup = group => `* @apiGroup ${group}`\r\nexport const apiVersion = apiVersion => `* @apiVersion ${apiVersion}`\r\nexport const apiDescription = apiDescription => `* @apiDescription ${apiDescription}`\r\nexport const apiPermission = apiPermission => `* @apiPermission ${apiPermission}`\r\nexport const apiHeader = (key, val) => `* @apiHeader ${key} ${val}`\r\nexport const apiSampleRequest = url => `* @apiSampleRequest ${url}`\r\nexport const apiParamExample = (type, desc) => `* @apiParamExample {${type}} ${desc}:`\r\nexport const apiParam = (type, name, value) => `* @apiParam {${type}} ${name} ${value}`\r\nexport const apiSuccess = (status, type, name, desc) => `* @apiSuccess (${status}) {${type}} ${name} ${desc}`\r\nexport const apiSuccessExample = (type, desc) => `* @apiSuccessExample {${type}} ${desc}:`\r\nexport const apiErrorExample = (type, desc) => `* @apiErrorExample {${type}} ${desc}:`\r\nexport const objToJsonStr = obj =>\"* \"+JSON.stringify(obj, null, 2).split(`\\n`).join(`\\n* `)\r\n","import {\r\n    api,\r\n    apiName,\r\n    apiGroup,\r\n    apiVersion,\r\n    apiDescription,\r\n    apiPermission,\r\n    apiHeader,\r\n    apiSampleRequest,\r\n    apiParam,\r\n    apiParamExample,\r\n    apiSuccess,\r\n    apiSuccessExample,\r\n    apiErrorExample,\r\n    objToJsonStr\r\n} from './helper.js'\r\nexport default sugar => {\r\n    let result = []\r\n    result.push('/**')\r\n    if (sugar.api) {\r\n        result.push(api(...sugar.api()))\r\n    }\r\n    if (sugar.name) {\r\n        result.push(apiName(sugar.name()))\r\n    }\r\n    if (sugar.group) {\r\n        result.push(apiGroup(sugar.group()))\r\n    }\r\n    if (sugar.version) {\r\n        result.push(apiVersion(sugar.version()))\r\n    }\r\n    if (sugar.description) {\r\n        result.push(apiDescription(sugar.description()))\r\n    }\r\n    if (sugar.permission) {\r\n        result.push(apiPermission(sugar.permission()))\r\n    }\r\n    if (sugar.header) {\r\n        //console.log(sugar.header())\r\n        result.push(apiHeader(sugar.header()))\r\n    }\r\n    if (sugar.sampleRequest) {\r\n        result.push(apiSampleRequest(sugar.sampleRequest()))\r\n    }\r\n    if (sugar.paramExample) {\r\n        result.push(apiParamExample(...sugar.paramExample().slice(0, 2)))\r\n        result.push(objToJsonStr(...sugar.paramExample().slice(2)))\r\n    }\r\n    if (sugar.param) {\r\n        //console.log(sugar.param())\r\n        sugar.param().forEach(v => {\r\n            result.push(apiParam(...v))\r\n        })\r\n    }\r\n    if (sugar.success) {\r\n        sugar.success().forEach(v => {\r\n            result.push(apiSuccess(...v))\r\n        })\r\n    }\r\n    if (sugar.successExample) {\r\n        result.push(apiSuccessExample(...sugar.successExample().slice(0, 2)))\r\n        result.push(objToJsonStr(...sugar.successExample().slice(2)))\r\n    }\r\n    if (sugar.failExample) {\r\n        result.push(apiErrorExample(...sugar.failExample().slice(0, 2)))\r\n        result.push(objToJsonStr(...sugar.failExample().slice(2)))\r\n    }\r\n    result.push('*/')\r\n    return result.join('\\n')\r\n}\r\n","import parser from './parser.js';\r\n//----make----\r\nexport default class Apidoc {\r\n    constructor(docId, data = null) {\r\n        this.id = docId\r\n        this.__data = data || {}\r\n    }\r\n    property(key, val = null, def = null) {\r\n        /*\r\n        if (key in this.__data ){\r\n            console.log(`--key:${key}---val:${val}--def:${def}`)\r\n        }\r\n        */\r\n        // set when (key,val)\r\n        if (val || val === '' || val === 0 || val === false) {\r\n            this.__data[key] = val\r\n        }\r\n        // set when (key,null,def)\r\n        else if (def) {\r\n            this.__data[key] = def\r\n            //return def\r\n        }\r\n        // get when (key)\r\n        else {\r\n            return (key in this.__data && this.__data[key]) || null\r\n        }\r\n        return this\r\n    }\r\n    // (new Apidoc('123')).property('host','127.0.0.1').property('port','8080').property('api','/')\r\n\r\n    registerMethod() {\r\n        /*\r\n        Object.keys(this.__data).forEach(key => {\r\n            if (!(key in this) && this.__data[key]) {\r\n                this[key] = (val, def) => this.property(key, val, def)\r\n            }\r\n        })\r\n        return this\r\n        */\r\n       let that = this\r\n        Object.keys(that.__data).forEach(key => {\r\n            if (!(key in that) && that.__data[key]) {\r\n                that[key] = (val, def) => that.property(key, val, def)\r\n            }\r\n        })\r\n        return that\r\n    }\r\n    //after registerMethod(), we can use as below:\r\n    // when set:\r\n    //(new Apidoc('123')).registerMethod().host('127.0.0.1').port(8080').api('/')\r\n    // when get:\r\n    //(new Apidoc('123')).registerMethod().host()\r\n    toStr (){\r\n        return parser(this)\r\n    }\r\n}\r\n","export default (sugar) =>\r\nsugar.property('host', '127.0.0.1')\r\n    .property('port', '8080')\r\n    .property('api', ['post', '/backend/admin/login', '管理人员登录'])\r\n    .property('name', '/api/backend/admin/list')\r\n    .property('group', '/api/backend/admin/list')\r\n    .property('version', 'ver1.0.0')\r\n    .property('description', '/backend/admin/login')\r\n    .property('permision', 'none')\r\n    .property('header', {\r\n        'Accept-Encoding': 'Accept-Encoding: gzip, deflate'\r\n    })\r\n    .property('param', [\r\n        ['Number', 'page', '第几页起'],\r\n        ['Number', 'limit', '每页几条']\r\n    ])\r\n    .property('success', [\r\n        ['200', 'Number', 'code', '返回代码'],\r\n        ['200', 'String', 'msg', ' 返回描述']\r\n    ])\r\n    .property('fail', [\r\n        ['404', 'Number', 'code', '返回代码'],\r\n        ['404', 'String', 'msg', ' 返回描述']\r\n    ])\r\n    .property('paramExample', ['json', '请求例子', {\r\n        \"page\": 5,\r\n        \"limit\": 10\r\n    }])\r\n    .property('successExample', ['json', '返回样例', {\r\n        code: 0,\r\n        msg: '操作成功'\r\n    }])\r\n    .property('failExample', ['json', '错误返回', {\r\n        code: -1,\r\n        msg: '操作失败'\r\n    }])\r\n    .property('sampleRequest', '127.0.0.1:8080/api/backend/admin/list')\r\n    .registerMethod()\r\n","import Apidoc from './apidoc.js';\r\n//import __toStr from './parser.js';\r\nimport writer from './writer.js';\r\n/*\r\nclass Engine extends sugar {\r\n    toStr() {\r\n        let that = this;\r\n        return __toStr(that);\r\n    }\r\n}\r\n*/\r\nconst doc = writer(new Apidoc());\r\ndoc.apidoc = (name = null, data = {}) => (new Apidoc(name,data));\r\nexport default doc\r\n"],"names":["const","let"],"mappings":";;;;;;;AAAOA,IAAM,GAAG,aAAI,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,uBAAc,MAAM,UAAK,IAAI,SAAI,KAAK,KAAE;AACjF,AAAOA,IAAM,OAAO,aAAG,MAAK,0BAAiB,IAAI,KAAE;AACnD,AAAOA,IAAM,QAAQ,aAAG,OAAM,2BAAkB,KAAK,KAAE;AACvD,AAAOA,IAAM,UAAU,aAAG,YAAW,6BAAoB,UAAU,KAAE;AACrE,AAAOA,IAAM,cAAc,aAAG,gBAAe,iCAAwB,cAAc,KAAE;AACrF,AAAOA,IAAM,aAAa,aAAG,eAAc,gCAAuB,aAAa,KAAE;AACjF,AAAOA,IAAM,SAAS,aAAI,GAAG,EAAE,GAAG,EAAE,4BAAmB,GAAG,SAAI,GAAG,KAAE;AACnE,AAAOA,IAAM,gBAAgB,aAAG,KAAI,mCAA0B,GAAG,KAAE;AACnE,AAAOA,IAAM,eAAe,aAAI,IAAI,EAAE,IAAI,EAAE,mCAA0B,IAAI,UAAK,IAAI,WAAG;AACtF,AAAOA,IAAM,QAAQ,aAAI,IAAI,EAAE,IAAI,EAAE,KAAK,EAAE,4BAAmB,IAAI,UAAK,IAAI,SAAI,KAAK,KAAE;AACvF,AAAOA,IAAM,UAAU,aAAI,MAAM,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,8BAAqB,MAAM,WAAM,IAAI,UAAK,IAAI,SAAI,IAAI,KAAE;AAC7G,AAAOA,IAAM,iBAAiB,aAAI,IAAI,EAAE,IAAI,EAAE,qCAA4B,IAAI,UAAK,IAAI,WAAG;AAC1F,AAAOA,IAAM,eAAe,aAAI,IAAI,EAAE,IAAI,EAAE,mCAA0B,IAAI,UAAK,IAAI,WAAG;AACtF,AAAOA,IAAM,YAAY,aAAG,KAAI,SAAE,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,GAAG,EAAE,IAAI,EAAE,CAAC,CAAC,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,MAAM,IAAC;;ACG5F,uBAAe,OAAM;IACjBC,IAAI,MAAM,GAAG,GAAE;IACf,MAAM,CAAC,IAAI,CAAC,KAAK,EAAC;IAClB,IAAI,KAAK,CAAC,GAAG,EAAE;QACX,MAAM,CAAC,IAAI,CAAC,SAAG,CAAC,QAAG,KAAK,CAAC,GAAG,EAAE,CAAC,EAAC;KACnC;IACD,IAAI,KAAK,CAAC,IAAI,EAAE;QACZ,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,IAAI,EAAE,CAAC,EAAC;KACrC;IACD,IAAI,KAAK,CAAC,KAAK,EAAE;QACb,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,KAAK,EAAE,CAAC,EAAC;KACvC;IACD,IAAI,KAAK,CAAC,OAAO,EAAE;QACf,MAAM,CAAC,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,OAAO,EAAE,CAAC,EAAC;KAC3C;IACD,IAAI,KAAK,CAAC,WAAW,EAAE;QACnB,MAAM,CAAC,IAAI,CAAC,cAAc,CAAC,KAAK,CAAC,WAAW,EAAE,CAAC,EAAC;KACnD;IACD,IAAI,KAAK,CAAC,UAAU,EAAE;QAClB,MAAM,CAAC,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,UAAU,EAAE,CAAC,EAAC;KACjD;IACD,IAAI,KAAK,CAAC,MAAM,EAAE;;QAEd,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,MAAM,EAAE,CAAC,EAAC;KACzC;IACD,IAAI,KAAK,CAAC,aAAa,EAAE;QACrB,MAAM,CAAC,IAAI,CAAC,gBAAgB,CAAC,KAAK,CAAC,aAAa,EAAE,CAAC,EAAC;KACvD;IACD,IAAI,KAAK,CAAC,YAAY,EAAE;QACpB,MAAM,CAAC,IAAI,CAAC,qBAAe,CAAC,QAAG,KAAK,CAAC,YAAY,EAAE,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAC;QACjE,MAAM,CAAC,IAAI,CAAC,kBAAY,CAAC,QAAG,KAAK,CAAC,YAAY,EAAE,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,EAAC;KAC9D;IACD,IAAI,KAAK,CAAC,KAAK,EAAE;;QAEb,KAAK,CAAC,KAAK,EAAE,CAAC,OAAO,WAAC,GAAE;YACpB,MAAM,CAAC,IAAI,CAAC,cAAQ,CAAC,QAAG,CAAC,CAAC,EAAC;SAC9B,EAAC;KACL;IACD,IAAI,KAAK,CAAC,OAAO,EAAE;QACf,KAAK,CAAC,OAAO,EAAE,CAAC,OAAO,WAAC,GAAE;YACtB,MAAM,CAAC,IAAI,CAAC,gBAAU,CAAC,QAAG,CAAC,CAAC,EAAC;SAChC,EAAC;KACL;IACD,IAAI,KAAK,CAAC,cAAc,EAAE;QACtB,MAAM,CAAC,IAAI,CAAC,uBAAiB,CAAC,QAAG,KAAK,CAAC,cAAc,EAAE,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAC;QACrE,MAAM,CAAC,IAAI,CAAC,kBAAY,CAAC,QAAG,KAAK,CAAC,cAAc,EAAE,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,EAAC;KAChE;IACD,IAAI,KAAK,CAAC,WAAW,EAAE;QACnB,MAAM,CAAC,IAAI,CAAC,qBAAe,CAAC,QAAG,KAAK,CAAC,WAAW,EAAE,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAC;QAChE,MAAM,CAAC,IAAI,CAAC,kBAAY,CAAC,QAAG,KAAK,CAAC,WAAW,EAAE,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,EAAC;KAC7D;IACD,MAAM,CAAC,IAAI,CAAC,IAAI,EAAC;IACjB,OAAO,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC;CAC3B;;ACnED,IAAqB,MAAM,GACvB,eAAW,CAAC,KAAK,EAAE,IAAW,EAAE;+BAAT,GAAG;;IAC1B,IAAQ,CAAC,EAAE,GAAG,MAAK;IACnB,IAAQ,CAAC,MAAM,GAAG,IAAI,IAAI,GAAE;EAC3B;AACL,iBAAI,8BAAS,GAAG,EAAE,GAAU,EAAE,GAAU,EAAE;iCAArB,GAAG;iCAAS,GAAG;;;;;;;;IAOhC,IAAQ,GAAG,IAAI,GAAG,KAAK,EAAE,IAAI,GAAG,KAAK,CAAC,IAAI,GAAG,KAAK,KAAK,EAAE;QACrD,IAAQ,CAAC,MAAM,CAAC,GAAG,CAAC,GAAG,IAAG;KACzB;;SAEI,IAAI,GAAG,EAAE;QACd,IAAQ,CAAC,MAAM,CAAC,GAAG,CAAC,GAAG,IAAG;;KAEzB;;SAEI;QACL,OAAW,CAAC,GAAG,IAAI,IAAI,CAAC,MAAM,IAAI,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,KAAK,IAAI;KAC1D;IACL,OAAW,IAAI;EACd;;;AAGL,iBAAI,4CAAiB;;;;;;;;;GASlB,IAAQ,IAAI,GAAG,KAAI;IAClB,MAAU,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,OAAO,WAAC,KAAI;QACrC,IAAQ,EAAE,GAAG,IAAI,IAAI,CAAC,IAAI,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,EAAE;YACxC,IAAQ,CAAC,GAAG,CAAC,aAAI,GAAG,EAAE,GAAG,EAAE,SAAG,IAAI,CAAC,QAAQ,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,KAAC;SACzD;KACJ,EAAC;IACN,OAAW,IAAI;EACd;;;;;;AAML,iBAAI,KAAK,oBAAG;IACR,OAAW,MAAM,CAAC,IAAI,CAAC;CACtB;;ACtDL,uBAAgB,KAAK,EAAE,SACvB,KAAK,CAAC,QAAQ,CAAC,MAAM,EAAE,WAAW,CAAC;KAC9B,QAAQ,CAAC,MAAM,EAAE,MAAM,CAAC;KACxB,QAAQ,CAAC,KAAK,EAAE,CAAC,MAAM,EAAE,sBAAsB,EAAE,QAAQ,CAAC,CAAC;KAC3D,QAAQ,CAAC,MAAM,EAAE,yBAAyB,CAAC;KAC3C,QAAQ,CAAC,OAAO,EAAE,yBAAyB,CAAC;KAC5C,QAAQ,CAAC,SAAS,EAAE,UAAU,CAAC;KAC/B,QAAQ,CAAC,aAAa,EAAE,sBAAsB,CAAC;KAC/C,QAAQ,CAAC,WAAW,EAAE,MAAM,CAAC;KAC7B,QAAQ,CAAC,QAAQ,EAAE;QAChB,iBAAiB,EAAE,gCAAgC;KACtD,CAAC;KACD,QAAQ,CAAC,OAAO,EAAE;QACf,CAAC,QAAQ,EAAE,MAAM,EAAE,MAAM,CAAC;QAC1B,CAAC,QAAQ,EAAE,OAAO,EAAE,MAAM,CAAC;KAC9B,CAAC;KACD,QAAQ,CAAC,SAAS,EAAE;QACjB,CAAC,KAAK,EAAE,QAAQ,EAAE,MAAM,EAAE,MAAM,CAAC;QACjC,CAAC,KAAK,EAAE,QAAQ,EAAE,KAAK,EAAE,OAAO,CAAC;KACpC,CAAC;KACD,QAAQ,CAAC,MAAM,EAAE;QACd,CAAC,KAAK,EAAE,QAAQ,EAAE,MAAM,EAAE,MAAM,CAAC;QACjC,CAAC,KAAK,EAAE,QAAQ,EAAE,KAAK,EAAE,OAAO,CAAC;KACpC,CAAC;KACD,QAAQ,CAAC,cAAc,EAAE,CAAC,MAAM,EAAE,MAAM,EAAE;QACvC,MAAM,EAAE,CAAC;QACT,OAAO,EAAE,EAAE;KACd,CAAC,CAAC;KACF,QAAQ,CAAC,gBAAgB,EAAE,CAAC,MAAM,EAAE,MAAM,EAAE;QACzC,IAAI,EAAE,CAAC;QACP,GAAG,EAAE,MAAM;KACd,CAAC,CAAC;KACF,QAAQ,CAAC,aAAa,EAAE,CAAC,MAAM,EAAE,MAAM,EAAE;QACtC,IAAI,EAAE,CAAC,CAAC;QACR,GAAG,EAAE,MAAM;KACd,CAAC,CAAC;KACF,QAAQ,CAAC,eAAe,EAAE,uCAAuC,CAAC;KAClE,cAAc,KAAE;;;ACnCrB;;;;;;;;AASAD,IAAM,GAAG,GAAG,MAAM,CAAC,IAAI,MAAM,EAAE,CAAC,CAAC;AACjC,GAAG,CAAC,MAAM,aAAI,IAAW,EAAE,IAAS,EAAE;+BAApB,GAAG;+BAAU,GAAG;;YAAQ,IAAI,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC;CAAC,CAAC;;;;"}